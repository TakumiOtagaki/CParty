# Story Audit

## Story
- id: 011
- title: Add get_structure_energy API and strict input contract
- depends_on: [010]
- attempt: 1
- date: 2026-02-13

## Commit
- branch: feature/scfg-refactor-fixed-energy
- commit: (pending)
- files_changed:
  - CMakeLists.txt
  - src/fixed_energy_api.hh
  - src/fixed_energy_api.cc
  - test/api_structure_energy_validation_test.cc
  - documents/ralph-loop/prd.json
  - documents/ralph-loop/audit/011.md
  - documents/ralph-loop/progress.txt

## Commands
```bash
cmake -S . -B build_story011_fresh_20260213_run1
cmake --build build_story011_fresh_20260213_run1
ctest --test-dir build_story011_fresh_20260213_run1 --output-on-failure -R api_structure_energy
ctest --test-dir build_story011_fresh_20260213_run1 --output-on-failure
ctest --test-dir build_story011_fresh_20260213_run1 -V -R api_cli_density2_energy_alignment
```

## Metrics
- refactor_compared: 152
- refactor_strict_mismatched: 0
- alignment_compared: 152
- alignment_mismatched: 0
- skipped: 0
- finite_rate: 100%

## Result
- passes: true
- rationale: Implemented `get_structure_energy(seq, db_full)` with deterministic input validation and fixed exception type (`std::invalid_argument`) for invalid API inputs, including explicit `T` rejection and dot-bracket sanity checks. Added source-registered validation test and passed both story-specific and full fresh-build regression gates.

## Blockers
- none
- Pre-existing unrelated dirty/untracked paths were left untouched: `Testing/`, `build_gate_fix/`, `build_review/`.
